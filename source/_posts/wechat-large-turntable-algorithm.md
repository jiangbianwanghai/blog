---
title: 基于微信的大转盘抽奖算法研究
date: 2021-08-23 12:09:14
tags: ["算法", "PHP"]
---

基于微信的大转盘抽奖功能大家相比都体验过。那么，它们中奖的概率是怎么算的呢？

其实，抽奖的算法主要包含：

1. 中奖概率的问题。大奖概率不能过高，不然会亏本。中奖概率也不能过低，不然不利于推广。
1. 用户人群的问题。奖项在什么时间会出现，如果出现的过早的活动的效果大打折扣，如果太晚可能奖品就发不完。
1. 超发的问题。在并发情况下，可能存在A和B同时中奖的问题。

基于上述问题。

设定时间线。奖品可以均匀的分步。

使用redis的原子性还解决并发和超发的问题。


抽中
扣奖品库存

直到奖项记录被写入记录表才能说明此用户获奖了。

##### 不可控

设定奖池大小，直接将奖品注入奖池。每抽一次，将此的奖券减少一张，直到奖券全部抽完，奖项才能种完。

这个过程有可能奖品中完了，无效的奖券还没有抽完。

##### 可控

设定一个奖池，奖池是带有时间戳。只有时间戳在这个范围内中奖的才能算中奖。

其实很简单

直接将奖品放入奖池，然手用随机数，如果随机数跟奖品匹配，则中奖。如果需要设定中奖是时间，可以先判断时间。
如果需要设置中奖的概率，也可以设定，参与人数大道多少出奖品。
